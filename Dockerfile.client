FROM node:20-bullseye AS base
WORKDIR /app

# Install dependencies first for better layer caching
COPY package.json package-lock.json ./
COPY src/clients/testbed/chatgpt-vite/package.json src/clients/testbed/chatgpt-vite/
RUN npm ci --ignore-scripts

# Copy source
COPY . .

# Vite dev server (run-time)
EXPOSE 5173

CMD ["npm", "run", "dev", "--workspace=src/clients/testbed/chatgpt-vite", "--", "--host", "0.0.0.0", "--port", "5173", "--strictPort"]
