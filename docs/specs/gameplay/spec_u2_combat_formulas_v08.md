# **Формулы для системы боя U2 v0.8**

## **Исходные параметры**

**Оружие:**

* `D_max` — максимальный урон  
* `R_opt` — оптимальная дальность (максимальная точность)  
* `C` — калибр оружия (диаметр)

**Цель:**

* `S` — сигнатура цели (диаметр)  
* `R` — фактическое расстояние до цели

---

## **1\. Множитель дальности**

Урон и точность падают линейно от `R_opt` до `2×R_opt`:

K\_range \= max(0, 1 \- (R \- R\_opt) / R\_opt)  
       \= max(0, (2×R\_opt \- R) / R\_opt)

* При `R ≤ R_opt`: `K_range = 1.0` (полная эффективность)  
* При `R = 1.5×R_opt`: `K_range = 0.5`  
* При `R ≥ 2×R_opt`: `K_range = 0` (не достает)

---

## **2\. Вероятность попадания**

Зависит от отношения сигнатуры к калибру. Чем больше цель относительно калибра, тем проще попасть:

P\_hit \= min(1.0, (S / C)^0.5) × K\_range

**Альтернативный вариант** (с более плавной кривой):

P\_hit \= (1 \- e^(-2×S/C)) × K\_range

**Примеры:**

* `S = C`: `P_hit = 1.0 × K_range` (калибр равен сигнатуре)  
* `S = 4×C`: `P_hit = 1.0 × K_range` (большая цель — попасть легко)  
* `S = 0.25×C`: `P_hit = 0.5 × K_range` (маленькая цель — сложнее)

---

## **3\. Множитель эффективного урона**

Отражает, какая доля урона "попадает в цель". Если калибр больше сигнатуры, часть урона теряется:

K\_damage \= min(1.0, S / C)

**Примеры:**

* `S = C`: `K_damage = 1.0` (100% урона применяется)  
* `S = 2×C`: `K_damage = 1.0` (цель достаточно большая)  
* `S = 0.5×C`: `K_damage = 0.5` (50% урона "проходит мимо")

---

## **4\. Итоговый урон**

Финальная формула с учетом попадания и эффективности:

Damage \= D\_max × P\_hit × K\_damage

Или раскрыто:

Damage \= D\_max × min(1.0, (S/C)^0.5) × K\_range × min(1.0, S/C)

---

## **Упрощенная сводная формула**

K\_range \= max(0, (2×R\_opt \- R) / R\_opt)

P\_hit \= min(1.0, sqrt(S/C)) × K\_range

K\_damage \= min(1.0, S/C)

Damage \= D\_max × P\_hit × K\_damage

---

## **Пример расчета**

**Данные:**

* Оружие: `D_max = 100`, `C = 10`, `R_opt = 500`  
* Цель: `S = 5`, `R = 600`

**Расчет:**

1. `K_range = max(0, (1000 - 600) / 500) = 0.8`  
2. `P_hit = min(1.0, sqrt(5/10)) × 0.8 = 0.707 × 0.8 = 0.566`  
3. `K_damage = min(1.0, 5/10) = 0.5`  
4. `Damage = 100 × 0.566 × 0.5 = 28.3`

---

## **Балансировочные параметры**

Для тонкой настройки можно добавить коэффициенты:

P\_hit \= min(1.0, (S/C)^α) × K\_range

K\_damage \= min(1.0, (S/C)^β)

* `α = 0.5` — умеренная зависимость попадания (рекомендуется)  
* `β = 1.0` — линейная зависимость урона (рекомендуется)

Можно менять для баланса классов оружия (пулеметы, снайперки, ракеты).
